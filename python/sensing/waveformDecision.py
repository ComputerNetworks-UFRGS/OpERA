"""
Copyright 2013 OpERA

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
"""

from algorithm.abstractAlgorithm import ThresholdAlgorithm
from utils import Logger

import numpy as np
import scipy.stats as sc


class WaveformDecision(ThresholdAlgorithm):
    """
    Class implementing a Waveform Algorithm.
    Uses Pearson correlation do math a received signal  with the known patterns.
    """

    WAVEFORMS = [[
(2.94857647545-3.69831105403j),(5.76453481987e-05+0.00384101447135j),(0.00669793317243+0.0340247130636j),(0.0156323800749+0.00916765673399j),(-0.0115551207621-0.0129754383745j),(0.0157264950299-0.00353788950205j),(-0.0231598930263+0.0162896819987j),(0.0260952990022-0.0179853685653j),(-6.13655034803+0.0254670312723j),(0.000463305396438+0.00127060230613j),(-0.0653293252257-0.00029246554495j),(-0.0127958483857+0.00470407926917j),(-0.0368164161665-0.00406619338128j),(-0.0446931912486+0.00840238706738j),(-0.0239384960198-0.0270764689681j),(0.0515545025338+0.0068226955986j),(8.32345874466-2.58129060208j),(0.0388826136095-0.00614653422236j),(-0.00316443426509+0.00751008953213j),(0.0359980216855+0.0344970669693j),(0.0106411905375-0.0240162808369j),(0.0412998522364-0.0145814176193j),(0.0102770046153+0.0608524463409j),(0.0148427460539+0.0359403027338j),(-0.0134987536073+1.22965925427j),(0.0207899580231-0.0202066527313j),(0.0148734964257-0.0149517268622j),(-0.034455091058+0.0414750441611j),(0.0776552891179+0.0070573398496j),(-0.0224460880016-0.0557770509747j),(0.0627595484328-0.0124083173524j),(-0.0631962919336-0.0162050326121j),(10.0286983238-0.43856124798j),(-0.0327419543509+0.00877478960708j),(-0.00577495207013+0.0445521903232j),(0.0491306475154-0.0510268431866j),(0.0213640189233-0.00395551125364j),(0.00610541462542+0.0171495291847j),(-0.00650599997485+0.0129807296343j),(0.04619273293-0.00447951406568j),(2.91064735926-2.32981350184j),(0.0136416257666+0.00643454523072j),(-0.0452005602607+0.0270200431967j),(0.0356969520488+0.00460993576542j),(0.102288551068+0.00541505662776j),(0.048848835083+0.000331707811952j),(0.00426489638499-0.02230605562j),(-0.0328630548328+0.0357711769737j),(-0.221266506602-4.70690267013j),(-0.0444818201944-0.0328500619122j),(-0.045299226041-0.027251571761j),(-0.0146219706342+0.0329092106333j),(-0.0438906746614+0.0025818782453j),(-0.00672852378286-0.0136764729004j),(0.0365045537971+0.0104677900065j),(0.0572002026088-0.0218253336203j),(25.3282038599+2.11073536168j),(0.0124038650069+0.00454674449682j),(0.0026057879216-0.0455251158114j),(0.00806384903172+0.0206194380534j),(-0.00345600779433+0.00812552302008j),(0.00510002260484-0.0114424725729j),(0.00669774056114-0.00419003654563j),(0.0247737640801-0.00426049001873j),(-10.6667769868-1.82041703024j),(0.00598441057425+0.00339386730433j),(-0.0168392529957+0.0413818153563j),(0.00357858735915+0.0329576118767j),(-0.0429492866324-0.0135500733949j),(0.034481058572-0.0486716878j),(0.0283447135616-0.0194525530805j),(-0.0142217403864-0.00832114004105j),(13.5440557629-1.21675319107j),(0.00399123775683+0.00571777084112j),(0.00178783430629+0.00972399291413j),(-0.02895235593+0.00439309830159j),(-0.0635355910693+0.00262130413171j),(0.00763433891869-0.0110122613844j),(0.000585753773076-0.0185041133568j),(0.00563848807141-0.0155800547025j),(-3.21524319806+0.958512542093j),(0.0278012589611-0.0182465959436j),(-0.0329233907502-0.0850085494271j),(-0.0347958043971+0.0221732509956j),(0.0142779544443+0.00458410624687j),(-0.0404131797359-0.0520624346276j),(0.0206236323505-0.0038985266115j),(-0.00350075313713-0.0427807145077j),(1.13127117662-0.248705075061j),(0.00266302211432+0.0177756912193j),(0.0290667414034-0.022289756104j),(0.0302145605741+0.000213255285025j),(0.0019242108969+0.0226624781538j),(-0.00486631390606-0.0202114002635j),(0.0128341297925-0.0275394097174j),(-0.0277358705248-0.0416362581399j),(3.37031795499-0.847439122303j),(0.0078178790012+0.0304609964266j),(0.0231152102148+0.0161320226751j),(-0.0153927485584-0.00381721257389j),(0.011512524204-0.000321097547705j),(0.0104643633947-0.011819404474j),(-0.00741459729023-0.0277792244969j),(-0.0353010690765-0.0139630176139j),(3.75321552186-0.794631799932j),(-0.0420585516565+0.0180952504966j),(-0.0755476702547+0.0363649238987j),(0.0036716174169-0.0781061603901j),(0.0142490544821+0.0106219741148j),(-0.00386981095367+0.0545334394971j),(0.00287663486966+0.0394357457213j),(-0.000494616504143+0.0213803784224j),(2.61184234619-0.995872607081j),(-0.0064563525248-0.00919401412308j),(0.0310624631442+0.0147329049529j),(-0.0204324836043-0.0800630489504j),(-0.0239491532167+0.0163522465609j),(-0.0389782884965+0.054849698078j),(-0.0444999156556+0.012373797547j),(0.016524878325-0.0221045158011j),(-7.30782228895+3.26025361938j),(0.0175411584065+0.0387639304301j),(0.0130326171217+0.0100193273529j),(0.0350968373869+0.0568530292714j),(-0.0730317972663+0.0246717218722j),(0.0627145345923-0.0573665971413j),(0.0155280265354+0.0234292895847j),(-0.0208693841902-0.0554437245309j),(-9.87985822397-0.523930346863j),(-0.0289251590248+0.0634586803942j),(-0.0104916643874-0.0332756602754j),(0.00898305007573-0.0556454543703j),(0.0160300017384+0.0182868644502j),(0.0507928552459+0.051734062541j),(-0.0309085252013+0.0482298019623j),(0.043724296579+0.0243901052411j),(3.35117578254-5.27901545729j),(0.0346889354648-0.0111263274517j),(-0.0145790178273+0.0248195315606j),(-0.0403308599251+0.0665480139305j),(-0.112187466731-0.003898492613j),(-0.0133137986392-0.0496352584613j),(0.069216667317-0.0296120494725j),(0.047491916467+0.0140420219091j),(2.95787546316-2.7233187087j),(0.00502190571574+0.0126374853503j),(0.0683210603632-0.0320367203589j),(0.0610573646563-0.0248583851396j),(0.0550423993584+0.000614623868509j),(0.0454535299008+0.0217541855013j),(0.0985720958357+0.0205584128076j),(0.0387354809457-0.0111386739696j),(3.68327224115+2.0037134078j),(0.0200723326958+0.0434951081681j),(0.00217929555436+0.0285780326231j),(-0.00985744869526+0.018251236428j),(0.0123624695962-0.0168927331465j),(-0.0223674157491+0.0237204352346j),(-0.0621679114391-0.00579654474834j),(-0.0289960908946+0.0313409983782j),(4.76165341464-0.766805646697j),(-0.0143412217457-0.0207588741726j),(0.0422169372775-0.00250934959568j),(-0.0094110979376+0.0580421522444j),(0.0239411467411-0.0208457073302j),(0.0159883437118-0.0141925548869j),(0.00872344830269-0.0308800812613j),(0.000335518452361+0.0823302451593j),(-8.95261456146+4.62331108222j),(-0.00768124585881-0.0414636673528j),(0.0133206071785-0.0483391931105j),(0.0324036892584+0.0177326681989j),(-0.0761866605698-0.0128965992018j),(0.0261884830786-0.023399184826j),(0.0191778664985-0.0109584871936j),(-0.00400713295449+0.0332161892945j),(-4.8891359143-0.733386541821j),(0.00165330051341+0.00494733625233j),(-0.0415606269414+0.0509368479536j),(-0.065096550944-0.00567481604487j),(0.0347957253446-0.0304067127402j),(-0.0122590345373+0.00616295192897j),(-0.0345123340169+0.0321129603439j),(0.00633187639693-0.0154441988569j),(-5.66704998472+1.22101564002j),(0.0223479562598-0.0319596374613j),(-0.0278548917696-0.00382457591507j),(-0.0343653059893+0.0105361926776j),(-0.047865300297+0.0210464786811j),(-0.0536628929908-0.0529718775573j),(-0.0068628775751-0.0242843633598j),(0.00154171854197-0.0540203416383j),(-7.02217348115+0.0185979426834j),(0.029353661693+0.0736417334881j),(0.0760162711152-0.0110764497565j),(-0.0333515470098-0.00105256082863j),(0.197054869634-0.00279481472899j),(-0.0202786771497+0.00816260748237j),(-0.0710272300558-0.0238323863752j),(-0.0148992055141-0.0245141695467j),(-1.44090072172+1.93728986997j),(0.00781541472983-0.00101999672085j),(-0.00227879822466-0.00939707344197j),(0.00370689139514-0.0111390513241j),(-0.0019795907367+0.00121294019825j),(-0.00692794588617-0.00808632825322j),(-0.00251751405877+0.00273871765421j),(-0.00644574014382-0.00223166329652j),(-0.853073354926+1.27063348247j),(0.00435062110857-0.00111004849046j),(-0.000179053414355-0.00330670813157j),(0.00299533941214-0.00641414955348j),(-0.00160040411717+0.000241286852713j),(-0.00433621167473-0.00455477126211j),(-0.00175444361027+0.00199205109652j),(-0.00465286525125-0.00127715682179j),(-0.744633292469+0.997235692648j),(0.00342065267228-0.000962429839447j),(2.0365376297e-05-0.00201717964671j),(0.00249783415337-0.00466517627016j),(-0.00146991199076+5.91979959922e-06j),(-0.00323098781244-0.00339214629337j),(-0.00133840916773+0.001696335153j),(-0.00369477435725-0.000950263168067j),(-0.688702306772+0.836247987876j),(0.00291377410423-0.000803485255986j),(2.629004901e-05-0.0014532102266j),(0.00218293422438-0.0037091791828j),(-0.00137080936102-7.54656447287e-05j),(-0.00257434615376-0.00279725940466j),(-0.0010712776836+0.00153643229819j),(-0.00307929340344-0.000781070255935j),(-0.651305908729+0.723576453302j),(0.00258119020361-0.000664446582794j),(-5.06060301137e-06-0.00114036598856j),(0.00196678258418-0.00309465213239j),(-0.00128766368485-0.00010472982205j),(-0.00212674805126-0.00243009333536j),(-0.000885450935447+0.00143377072615j),(-0.00264455290021-0.0006779164958j),(-0.623230606204+0.637511054819j),(0.00234151546521-0.000547373384237j),(-4.1533231541e-05-0.000944764630335j),(0.00180905151896-0.00266122793436j),(-0.00121654021057-0.000113503500573j),(-0.00179711057209-0.00217818526834j),(-0.000750211076647+0.00136027166887j),(-0.00231859337669-0.000609507881701j),(-0.600773953708+0.568229589239j),(0.00215848344467-0.000448898162693j),(-7.49774328068e-05-0.000813386770724j),(0.00168856857513-0.00233632229269j),(-0.00115507280366-0.00011399326253j),(-0.00154173833728-0.00199309148282j),(-0.000648884853674+0.00130381536773j),(-0.00206373649857-0.000561729642376j),(-0.582086081162+0.510472687719j),(0.00201293681759-0.000365246793032j),(-0.00010347672102-0.000720872768378j),(0.00159335765362-0.00208187312961j),(-0.0011015430834-0.000111538627394j),(-0.00133671007633-0.00185024158955j),(-0.000571623786949+0.00125829016472j),(-0.00185819409013-0.000527203522921j),(-0.566107835027+0.461095739176j),(0.00189375688255-0.000293373860717j),(-0.000126990917921-0.000653563114118j),(0.00151611410201-0.00187598268628j),(-0.00105446553929-0.000108393770028j),(-0.00116748005971-0.00173599821746j),(-0.000511870039105+0.00122026536491j),(-0.00168837870523-0.000501545500755j),(-0.55217285261+0.418068857262j),(0.0017938907564-0.000230750978589j),(-0.000145984994362-0.000603403202298j),(0.00145207172514-0.00170503255129j),(-0.00101278934471-0.000105714294432j),(-0.00102486177757-0.00164198075175j),(-0.000465488127197+0.00118776155021j),(-0.00154531938799-0.000482019786835j),(-0.539832150683+0.380004450481j),(0.00170865873277-0.000175564977825j),(-0.000161094307899-0.000565427483916j),(0.00139808783531-0.00156018877864j),(-0.000975660987851-0.000103924103507j),(-0.000902561518997-0.00156280866086j),(-0.000429403344691+0.00115938085179j),(-0.00142285403214-0.000466949752569j),(-0.52876906135+0.345913534082j),(0.00163483596413-0.000126300635636j),(-0.000172961439351-0.000536468880402j),(0.00135184516407-0.00143531918824j),(-0.000942342312515-0.000103127363695j),(-0.000796185362025-0.00149489769042j),(-0.000401348528804+0.00113422528849j),(-0.00131661241515-0.000455074723065j),(-0.518750854818+0.315064970226j),(0.00157014332576-8.19891384244e-05j),(-0.00018200541167-0.000514103459364j),(0.00131182594654-0.00132617894232j),(-0.000912248432689-0.00010335808212j),(-0.000702506062912-0.00143575392485j),(-0.000379861104278+0.00111178950995j),(-0.00122337322052-0.000445571155548j),(-0.509600641036+0.286904991376j),(0.00151278420967-4.16383868456e-05j),(-0.000188720585592-0.000496761901055j),(0.00127674906152-0.001229612481j),(-0.000884966077099-0.000104584966207j),(-0.000619174661107-0.00138355705425j),(-0.000363572240636+0.0010914289806j),(-0.00114074931318-0.000437848343849j),(-0.50118183581+0.261002169873j),(0.00146154204225-4.5893985033e-06j),(-0.000193363952284-0.000483468092774j),(0.00124578814665-0.00114333485425j),(-0.000860104419195-0.000106646057745j),(-0.000544336248264-0.0013369442673j),(-0.000351624007969+0.0010729197929j),(-0.00106689831674-0.000431431474835j),(-0.493384870527+0.237015693712j),(0.0014153529511+2.96706050634e-05j),(-0.000196472352607-0.00047320580987j),(0.00121817584996-0.00106548434675j),(-0.00083729306258-0.00010953967471j),(-0.000476648490152-0.00129495118588j),(-0.000343255909577+0.00105592810286j),(-0.00100036855706-0.00042604714036j),(-0.48612414298+0.214671607796j),(0.0013734712568+6.15749523044e-05j),(-0.000198022403057-0.000465431901606j),(0.00119340819914-0.000994722534418j),(-0.000816308637377-0.000113116678413j),(-0.000414930873052-0.00125673173577j),(-0.000337893061263+0.0010402260428j),(-0.000940031785217-0.000421468161941j),(-0.47932583895+0.193743997301j),(0.00133523479548+9.15381088853e-05j),(-0.000198303821229-0.000459716685572j),(0.00117100492262-0.000929968329072j),(-0.000796947473197-0.000117276667068j),(-0.000358316101326-0.00122177169889j),(-0.000335047989495+0.00102571824652j),(-0.000885037377966-0.000417424565852j),(-0.472932852915+0.174049016624j),(0.00130017410444+0.000119779090583j),(-0.000197600248499-0.000455621678275j),(0.00115068299926-0.000870345089734j),(-0.0007789484938-0.000121995447468j),(-0.000306085082541-0.0011894890973j),(-0.000334411716837+0.00101215677959j),(-0.000834539974335-0.000413809635192j),(-0.466894028298+0.155430118148j),(0.0012678412354+0.000146630248427j),(-0.000195923781448-0.000452848181566j),(0.00113207575329-0.000815122801661j),(-0.000762209694399-0.000127160186353j),(-0.00025760701281-0.00115955252886j),(-0.000335580141019+0.000999532990087j),(-0.00078800500352-0.000410530840755j),(-0.461169325914+0.137755828044j),(0.0012379390986+0.000172208774686j),(-0.000193471718442-0.000451245172451j),(0.00111503179983-0.000763704560399j),(-0.000746568669315-0.000132738459967j),(-0.000212428835268-0.00113163250953j),(-0.000338430224574+0.00098768254915j),(-0.000744944975208-0.000407461039722j),(-0.455721313551+0.120914603337j),(0.00121008369084+0.000196750753522j),(-0.000190238760525-0.000450572890487j),(0.001099269016-0.000715652090609j),(-0.000731912837359-0.000138667682556j),(-0.000170114133729-0.00110549090564j),(-0.000342581933515+0.000976485462225j),(-0.000704884465817-0.00040455983609j),(-0.450518694137+0.104809950515j),(0.00118416094728+0.000220364550352j),(-0.00018639427809-0.000450655488135j),(0.0010846943144-0.000670530463457j),(-0.000718162457464-0.000144900728144j),(-0.000130328276602-0.00108082103133j),(-0.000347998316302+0.000965917175746j),(-0.000667512917319-0.000401740598679j),(-0.445535888299+0.0893573104581j),(0.00115986867869+0.000243184730783j),(-0.000182037554024-0.000451470184686j),(0.00107110549847-0.000627995941117j),(-0.00070526822626-0.000151364864376j),(-9.27782339793e-05-0.00105754233507j),(-0.000354553061184+0.000955979572545j),(-0.000632516063987-0.000399012393653j),(-0.440749234079+0.074483904183j),(0.00113709186104+0.000265354425684j),(-0.00017713888814-0.000452848753411j),(0.00105841297062-0.000587774352804j),(-0.000693043009131-0.00015812555186j),(-5.71781223878e-05-0.00103544921964j),(-0.00036212582264+0.000946514705525j),(-0.000599612962361-0.000396298219711j),(-0.436137300428+0.0601240775579j),(0.00111563702916+0.000286917491183j),(-0.000171805459305-0.000454691558439j),(0.00104655397493-0.000549598445185j),(-0.000681471898024-0.000165071676053j),(-2.33113831303e-05-0.00101441492073j),(-0.000370538921209+0.000937513339636j),(-0.000568636066543-0.000393498671427j),(-0.431683210401+0.0462209860022j),(0.00109540527675+0.00030800806433j),(-0.000166033091587-0.000457046290859j),(0.00103536237237-0.000513271978684j),(-0.000670529108114-0.00017219937872j),(9.02976199638e-06-0.000994328764044j),(-0.000379706414953+0.000928888841407j),(-0.000539313252941-0.000390680635944j),(-0.427368631573+0.032723272535j),(0.00107626611882+0.000328712081313j),(-0.000159941511592-0.000459682102574j),(0.001024790866-0.00047860104382j),(-0.000660092827384-0.000179522016053j),(3.99303303496e-05-0.000975109449625j),(-0.000389712826667+0.000920707508464j),(-0.000511565723583-0.000387760758996j),(-0.4231810048+0.0195842319298j),(0.00105814850972+0.000349041839838j),(-0.000153436170533-0.000462710888116j),(0.00101480592134-0.000445410184264j),(-0.000650166775599-0.000186980349242j),(6.96592215466e-05-0.000956580852568j),(-0.000400339438679+0.000912884831982j),(-0.000485192770848-0.000384740899205j),(-0.419105656341+0.00676137888535j),(0.00104091223397+0.00036915050447j),(-0.000146564943226-0.00046602571565j),(0.00100532000768-0.000413574314117j),(-0.000640657698038-0.000194568929418j),(9.82770780399e-05-0.000938794947267j),(-0.000411619230848+0.000905327706236j),(-0.000460106077396-0.000381580760479j),(-0.415130681249-0.00578282937996j),(0.00102455602462+0.000388973537087j),(-0.000139441921766-0.000469681487937j),(0.000996272695118-0.000382974282503j),(-0.000631604968662-0.000202329970998j),(0.000125911019668-0.000921602553725j),(-0.000423527125702+0.000898058364873j),(-0.000436135919848-0.000378272896409j),(-0.41124658937-0.0180847938554j),(0.00100893038013+0.000408674475551j),(-0.000132051956927-0.000473550709644j),(0.000987591394823-0.000353455998003j),(-0.000622893215653-0.000210185552724j),(0.000152668275848-0.000904963388145j),(-0.000435940016083+0.000891099529743j),(-0.000413236447704-0.000374834023938j),(-0.407440134817-0.0301773179308j),(0.000994061378577+0.000428248708844j),(-0.000124305826097-0.00047765712261j),(0.000979272086933-0.000324951182157j),(-0.000614570905353-0.000218146325867j),(0.000178670849826-0.000888817545921j),(-0.000448964302417+0.000884395712939j),(-0.000391292904603-0.000371171974242j),(-0.403705116845-0.0420909992456j),(0.000979836656052+0.000447800762951j),(-0.000116316341202-0.000482020516114j),(0.000971268334395-0.000297369334847j),(-0.000606517114041-0.000226214338245j),(0.000203965324386-0.000873156860098j),(-0.000462530567701+0.000877848938166j),(-0.00037022488927-0.000367331303954j),(-0.400030907291-0.0538561179803j),(0.000966262087523+0.000467291716039j),(-0.000108057847146-0.000486509607512j),(0.000963539798586-0.000270619973466j),(-0.000598789028764-0.000234390844203j),(0.00022867562524-0.000857886965573j),(-0.000476619835142+0.000871584357972j),(-0.000350021247384-0.000363249254674j),(-0.39640943467-0.0654989369671j),(0.000953228315861+0.000486852256656j),(-9.95558191304e-05-0.000491185891637j),(0.000956072881737-0.000244659986496j),(-0.000591347475314-0.000242710472487j),(0.00025286445749-0.000843001800627j),(-0.000491176641513+0.000865506371927j),(-0.000330527103505-0.000358922823966j),(-0.39283346918-0.0770470768636j),(0.000940778511047+0.000506467092782j),(-9.07009759433e-05-0.000496114958477j),(0.000948803079864-0.000219372006357j),(-0.000584136611319-0.000251106545649j),(0.000276605286087-0.000828445161283j),(-0.000506298501128+0.000859624076017j),(-0.000311733402331-0.00035437245518j),(-0.389294572239-0.0885262808307j),(0.000928774674557+0.000526218141317j),(-8.16624144757e-05-0.000501198769348j),(0.000941754493487-0.000194757074118j),(-0.000577152752378-0.000259584245385j),(0.000299965539499-0.000814202969968j),(-0.000521918398202+0.000853889375463j),(-0.000293604793589-0.000349466965795j),(-0.385786883756-0.0999616386772j),(0.000917301159571+0.000546148439944j),(-7.23259484961e-05-0.000506524661123j),(0.000934804526464-0.00017073857978j),(-0.00057035105525-0.000268217914469j),(0.000322985725251-0.000800232084766j),(-0.000538107179603+0.000848338260398j),(-0.000276069997758-0.000344335659444j),(-0.382301990128-0.111378622518j),(0.000906279584952+0.00056630105108j),(-6.27218149602e-05-0.000511904911194j),(0.000928001577854-0.000147210829854j),(-0.000563850753758-0.000276915017122j),(0.000345772486925-0.000786523477435j),(-0.000554741388634+0.000842938775211j),(-0.000259114579856-0.00033881763339j),(-0.378833536446-0.122802463136j),(0.00089568434+0.000586728338003j),(-5.28255167603e-05-0.000517604318272j),(0.000921311022341-0.000124243215322j),(-0.000557433761892-0.000285736444211j),(0.00036834209159-0.000773075856864j),(-0.000571976031065+0.000837616665329j),(-0.000242656301111-0.000332975115478j),(-0.375375918856-0.134257320592j),(0.000885498524935+0.000607493366301j),(-4.26674189075e-05-0.000523460432889j),(0.000914691933403-0.000101698204875j),(-0.000551218226197-0.00029467583361j),(0.000390788990706-0.000759773313999j),(-0.000589806148137+0.000832467797357j),(-0.000226705948189-0.000326716168523j),(-0.371919444416-0.145770200223j),(0.000875750391185+0.000628614912033j),(-3.21989578009e-05-0.000529446251392j),(0.000908137183189-7.96140503883e-05j),(-0.000545155240888-0.000303699402609j),(0.000413139847666-0.000746713141501j),(-0.000608193426728+0.000827453121648j),(-0.000211201782147-0.00032004976809j),(-0.368460189654-0.157366892193j),(0.000866375060814+0.000650185135901j),(-2.1440905342e-05-0.00053570372008j),(0.000901603038086-5.79050970078e-05j),(-0.000539226118217-0.000312860039776j),(0.000435436395423-0.000733800110072j),(-0.000627167526724+0.000822479766767j),(-0.000196144342259-0.000312912388891j),(-0.364989316221-0.169075208919j),(0.000857393713284+0.000672241426557j),(-1.03001108618e-05-0.000542183076984j),(0.000895066586856-3.6549731642e-05j),(-0.000533424899985-0.000322134792796j),(0.000457815970106-0.000721038577557j),(-0.000646761344461+0.000817654713391j),(-0.000181532551905-0.000305289014876j),(-0.361501805826-0.180923504455j),(0.00084877947331+0.00069485416472j),(1.1122940111e-06-0.000548835883413j),(0.00088850138153-1.55522418022e-05j),(-0.000527733233492-0.000331538407698j),(0.000480290182166-0.000708435100168j),(-0.00066708901541+0.000812889089059j),(-0.00016730491007-0.00029711861819j),(-0.357988436597-0.192942024172j),(0.000840540054493+0.000718079634309j),(1.28944761109e-05-0.000555774282431j),(0.000881856632626+5.13052344322e-06j),(-0.000522181181546-0.000341061662934j),(0.00050293550469-0.000695947581828j),(-0.000688076998819+0.000808278355361j),(-0.000153432685435-0.000288337657154j),(-0.354440723947-0.205164504422j),(0.000832685321683+0.000742047805786j),(2.50727756454e-05-0.00056293031784j),(0.000875161570568+2.55147862434e-05j),(-0.000516735313277-0.000350707329864j),(0.000525802934191-0.000683566359878j),(-0.000709757807509+0.000803711466061j),(-0.000139958646512-0.000278910311759j),(-0.350853695716-0.217625160924j),(0.000825218902523+0.000766787215918j),(3.75981467318e-05-0.000570428480336j),(0.000868288939256+4.56264302135e-05j),(-0.000511381624252-0.000360515740334j),(0.000548978456393-0.000671299636066j),(-0.00073231006481+0.000799183017271j),(-0.000126831079426-0.000268766756654j),(-0.347214296905-0.230362354156j),(0.000818099967336+0.000792412569523j),(5.05273992442e-05-0.000578164628742j),(0.000861277720415+6.54833844304e-05j),(-0.000506090219089-0.000370432049832j),(0.000572542807056-0.000659106028825j),(-0.000755694592644+0.000794760102455j),(-0.000114087850708-0.000257806513608j),(-0.34351609846-0.243417000971j),(0.000811373060704+0.000819041293561j),(6.39186722475e-05-0.000586233715075j),(0.000854076841853+8.50407034159e-05j),(-0.000500888158567-0.000380519567548j),(0.000596599152337-0.000647048692852j),(-0.000779910541993+0.000790389672094j),(-0.000101655993897-0.000245999061614j),(-0.339748908608-0.256836150442j),(0.000805053236782+0.000846758216023j),(7.77822619145e-05-0.000594770374736j),(0.000846572468361+0.000104351882339j),(-0.000495723363105-0.000390750877442j),(0.000621201972393-0.000635044510216j),(-0.00080519299246+0.000786017424691j),(-8.95744149767e-05-0.000233233870268j),(-0.335900537794-0.270670034033j),(0.000799147923709+0.000875719636679j),(9.22643256075e-05-0.000603552325795j),(0.000838813927928+0.000123409989774j),(-0.000490623885769-0.000401110578467j),(0.000646506514614-0.000623158656359j),(-0.000831393542207+0.000781756263168j),(-7.78368727671e-05-0.000219339366257j),(-0.331958715806-0.28497756067j),(0.000793707226768+0.000906100532413j),(0.000107185436671-0.000612859237042j),(0.000830649158269+0.000142177721858j),(-0.000485551147166-0.000411671866731j),(0.000672577651368-0.000611336107552j),(-0.000858728447335+0.000777444372511j),(-6.64370106497e-05-0.000204231649935j),(-0.327908156325-0.299822680061j),(0.000788712162156+0.000938009960651j),(0.000122629307826-0.000622661663057j),(0.000822049127027+0.000160680048466j),(-0.000480537240034-0.00042234507069j),(0.00069962218866-0.000599635858536j),(-0.00088734900485+0.000773263382252j),(-5.54410121824e-05-0.000187770859897j),(-0.323736483478-0.315278536572j),(0.000784209054168+0.000971677234992j),(0.000138691311999-0.00063292849821j),(0.000812932900227+0.000178849354722j),(-0.000475493472547-0.000433182069177j),(0.000727731297573-0.000588036064208j),(-0.000917269661169+0.000769041197898j),(-4.48469387711e-05-0.000169775739945j),(-0.319422454284-0.331431531001j),(0.000780272329223+0.00100739135195j),(0.000155401822281-0.000643945885461j),(0.000803159530905+0.000196696159393j),(-0.000470499596186-0.000444168977994j),(0.000757171243317-0.000576575301588j),(-0.000948586079653+0.000764849486287j),(-3.46271606922e-05-0.000150007541589j),(-0.314947359152-0.34837953938j),(0.000776905082247+0.00104535049344j),(0.000172828023165-0.00065564370504j),(0.00079264521837+0.000214111969098j),(-0.000465484639095-0.000455286538663j),(0.000788056512979-0.000565292352922j),(-0.000981434952672+0.000760538392951j),(-2.48692254958e-05-0.000128222779632j),(-0.310287097047-0.366237042238j),(0.000774201223523+0.00108585480556j),(0.000191043055682-0.00066802100031j),(0.00078121584426+0.000231098401733j),(-0.000460416157517-0.000466541023893j),(0.000820735041048-0.000554198377728j),(-0.00101596018744+0.000756311131643j),(-1.55991068409e-05-0.00010416698914j),(-0.305412441538-0.385139299812j),(0.000772247105179+0.00112933030546j),(0.000210006532231-0.000681475944293j),(0.000768712814079+0.000247501036525j),(-0.000455360558038-0.000477869257967j),(0.000855461191668-0.000543349378109j),(-0.00105238820797+0.000751984796066j),(-6.83002130664e-06-7.74652135372e-05j),(-0.300291492887-0.405246956884j),(0.000771081725222+0.00117621825159j),(0.000229826095984-0.00069591842535j),(0.000754936230507+0.000263251622021j),(-0.000450198996156-0.000489282684477j),(0.000892639807241-0.000532841692269j),(-0.0010909011755+0.000747631756621j),(1.34109478247e-06-4.7655839324e-05j),(-0.294883790374-0.426753524981j),(0.000770885759974+0.00122703796566j),(0.000250629411904-0.000711671775759j),(0.000739577603815+0.000278123951107j),(-0.000444901591686-0.000500749287662j),(0.000932698592313-0.000522778796554j),(-0.00113165433083+0.000743182780046j),(8.82408181474e-06-1.41929274797e-05j),(-0.289141021203-0.449892015991j),(0.000771770384855+0.00128251182914j),(0.000272346867566-0.000728894229859j),(0.000722303261214+0.000291962186098j),(-0.000439544888629-0.000512163231322j),(0.000976264895126-0.000513261230886j),(-0.00117494885855+0.000738540323362j),(1.55053377059e-05+2.35409700871e-05j),(-0.283003975968-0.474950292566j),(0.000773863451468+0.00134344537973j),(0.000295127151882-0.000747851560554j),(0.00070270873319+0.000304440679252j),(-0.000433982488021-0.000523457371223j),(0.00102398007362-0.000504498358369j),(-0.00122106501503+0.000733790871918j),(2.13073922519e-05+6.64324870706e-05j),(-0.276396624253-0.5022864868j),(0.000777429803572+0.00141085033149j),(0.000318849598102-0.000768953635914j),(0.00068023105903+0.000315172361955j),(-0.000428146919108-0.000534489314813j),(0.00107685044267-0.000496717503518j),(-0.00127034382564+0.00072877189921j),(2.59926079092e-05+0.000115471817851j),(-0.269227115661-0.5323510707j),(0.000782696617557+0.00148610887244j),(0.000343787265678-0.000792803460498j),(0.000654140337011+0.000323620700687j),(-0.000421974331196-0.000545129565661j),(0.00113599342235-0.000490326426476j),(-0.00132309504327+0.000723348216672j),(2.94271098585e-05+0.000172165465355j),(-0.261370442916-0.565724607203j),(0.000790079132394+0.00157094815634j),(0.0003697625078-0.000819908403676j),(0.000623428422855+0.000329049630165j),(-0.000415427868199-0.000555057203848j),(0.00120304371744-0.000485711383596j),(-0.00137990046045+0.000717542321846j),(3.12856004897e-05+0.000238256407678j),(-0.252667706148-0.603163980445j),(0.000799936795571+0.00166762854636j),(0.000396719120794-0.000851175457993j),(0.000586896544018+0.000330387619883j),(-0.000408297416292-0.000563959398066j),(0.00128015177471-0.000483688168079j),(-0.00144123592012+0.000711111180555j),(3.11554696046e-05+0.000316312164962j),(-0.242900408016-0.645680884412j),(0.000812883438646+0.00177938044488j),(0.000424418618392-0.000887923507047j),(0.000542664142093+0.000326125726104j),(-0.000400351571052-0.000571256278437j),(0.00137026328483-0.000485172746629j),(-0.00150771256679+0.000703800021537j),(2.85770812439e-05+0.000409764738083j),(-0.231767029287-0.69466194982j),(0.000829701124861+0.00191054462969j),(0.000452452084318-0.000931886193293j),(0.000488247692805+0.000313998368531j),(-0.000391292164174-0.000576124117094j),(0.00147769448079-0.000491746439338j),(-0.00158006566992+0.000695315799251j),(2.28422861138e-05+0.000523631061316j),(-0.218834811975-0.752066856679j),(0.000851499051373+0.00206753728144j),(0.000479820632021-0.000985640141605j),(0.000419856953964+0.00029048920393j),(-0.000380616253036-0.000577261897516j),(0.00160869791671-0.000505739797875j),(-0.00165901200133+0.000685214693035j),(1.30004748098e-05+0.000665394325778j),(-0.203459127988-0.820767050165j),(0.00087992792923+0.00226007687569j),(0.000504814676913-0.00105342018745j),(0.000331843375564+0.000250160568953j),(-0.000367527914836-0.000572539938136j),(0.00177308374465-0.000530932136178j),(-0.00174510348652+0.000672749247649j),(-2.5384503603e-06+0.00084689111948j),(-0.184628079742-0.90517360908j),(0.000917369374633+0.00250381812871j),(0.000523786436915-0.00114203637452j),(0.000215169433355+0.000183681228161j),(-0.000350633468051-0.000558152267951j),(0.00198688357189-0.000573659954667j),(-0.00183862562418+0.000656821835305j),(-2.61065165699e-05+0.00108814372838j),(-0.160651806483-1.01248180833j),(0.000967896190912+0.00282582694292j),(0.000529115963985-0.00126365057588j),(5.43059316371e-05+7.4556915164e-05j),(-0.000327359706314-0.000527075027382j),(0.00227858829185-0.000645214746594j),(-0.00193828689458+0.000635420918125j),(-6.20129287988e-05+0.00142637857318j),(-0.12844754595-1.15541847357j),(0.00103888976753+0.00327817413896j),(0.000503053357601-0.0014418937397j),(-0.000179785753489-0.000109411770701j),(-0.000292301706802-0.000464261381232j),(0.00270482304767-0.000767241125703j),(-0.00203686661363+0.000605417067811j),(-0.000119396045427+0.00194169713736j),(-0.0816246146261-1.35930243579j),(0.00114681043326+0.00397865606636j),(0.000398076926013-0.00173181607157j),(-0.000550677389727-0.000439042255878j),(-0.000232057715608-0.000331577335736j),(0.00339958570139-0.00098505682528j),(-0.00210550868178+0.000558837292056j),(-0.000224933768049+0.00285230356157j),(-0.00385180387992-1.68472489902j),(0.00134304073854+0.00527524196655j),(4.92078229933e-05-0.00229778683687j),(-0.00124329150679-0.0011013699314j),(-0.000101893539719+5.34355274027e-06j),(0.00480791464098-0.00139877723545j),(-0.00198717277878+0.00046183734089j),(-0.000532978197595+0.00511188820496j),(0.167977419565-2.33688443732j),(0.00197514479358+0.00900063065052j),(-0.00155654513765-0.00401628199992j),(-0.00341684050945-0.00273097478658j),(0.000385503964569+0.00163230204814j),(0.0109116618519-0.00168438010097j),(0.00175712852164-0.00107640887045j),(-0.0115271935188+0.0402420932594j),(7.29171296122-5.42473587061j),(-0.0218355915236-0.0280497825781j),(-0.0456729312074+0.0272437240206j),(-0.0114029094144+0.000621501100957j),(0.0204220936304-0.00531524716431j),(-0.00571765578829+0.00589917631909j),(-0.0166673248024+0.0156668733875j),(-0.00789348231554-0.014975993726j),(11.2113586859-0.0114320966792j),(0.00931704897653+0.00931330804855j),(-0.00435022845881-0.0148459219458j),(1.70252148435e-06-0.0372616856089j),(0.0328690602406-0.00333615262934j),(0.00739758212177+0.0500411951432j),(-0.011231590675+0.000538055304421j),(-0.0102436641497+0.0416278331447j),(18.1321975345-3.53459040574j),(-0.010892076368-0.0227023510233j),(0.00844051531679+0.00081430264732j),(-0.0425792654872+0.0414844916525j),(0.0341640762977+0.00404236322165j),(-0.0385363152027-0.0220343478239j),(-0.0300213762184-0.0171023726249j),(-0.00753309457168+0.0143029827154j),(-8.13885767961+1.51118296105j),(-0.0101319020236-0.0143522708249j),(-0.0126304443996+0.0114473430389j),(0.000725333625014-0.00202530064642j),(0.0223126456557-0.00643655296798j),(-0.00346792195667+0.00986789852709j),(-0.0052591709739+0.00320840650302j),(0.000381011871952+0.015685994924j),(-0.885600863138-0.29802668171j),(-0.00318456996246-0.0318376504159j),(-0.0130275571979+0.00523819881733j),(-0.0786605249988+0.0275316934532j),(0.108189136307-0.00181116748564j),(-0.104832060884-0.00750418020457j),(-0.00516078778304+0.0136884194098j),(-0.0153486522937-0.0252825055295j),(4.77972393147+0.303586600928j),(-0.0175642923409+0.00705411165655j),(-0.00148562201773+0.00111357132153j),(0.0683045426697+0.012733641451j),(-0.0425036129589+0.000973736769033j),(0.0257673341428+0.0046990855962j),(0.0208889150696+0.00258597462379j),(0.00687276349109-0.0328247783446j),(10.6073038682+2.77637860095j),(0.0161340022005+0.0266209587586j),(0.0047170940858+0.00758299792903j),(0.0226496251728+0.0348045019016j),(-0.0342526921414-0.00728316056347j),(0.0142453577576-0.0294670692649j),(0.00286133218803+0.00219499640325j),(-0.0153006227891-0.00722471282274j),(10.4514918446-2.89025705258j),(-0.0120699199611+0.016391189698j),(0.0232389612677-0.0123253770359j),(0.00658853407642+0.0635763046557j),(-0.0876461990449-0.0120293669193j),(0.00762053229772-0.0745862182748j),(-0.0148709083716+0.0301926889715j),(-0.0252328682809+0.0192436651468j),(11.9267575856+2.83123491282j),(-0.0186516868093-0.0225380042332j),(0.000511477982123-0.011212754846j),(0.000924890262886-0.0657986681855j),(0.000258407892334+0.0132244201141j),(0.00368289527938+0.0299189919186j),(-0.00151783583046-0.00115254301992j),(0.00472761526545-0.00253163987577j),(0.0242263992423+0.332582539413j),(-0.000362439674488-0.0121841535158j),(-0.0290470572165+0.0219116925123j),(0.000868539389279-0.0151463565072j),(-0.0451525125541-0.00901124880792j),(0.0128580877487-0.00497084140102j),(-0.00812925044356-0.00841600520071j),(-0.00903102395723-0.0291098014471j),(-10.7119821284+2.91048902997j),(-0.00747026508556+0.0206709988949j),(0.00539558385984+0.00875045386801j),(-0.0272946240622-0.0270172021187j),(-0.041503368385+0.000472651214223j),(-0.0330492070181+0.0377947958418j),(0.00237392797183+0.00922018404548j),(-0.00847766796766-0.0166921470347j),(-10.6180404948+0.708749829361j),(-0.0134402585873+0.0242611920662j),(0.0219218179243-0.0171307544551j),(0.0271866047114+0.0206592983367j),(0.0344727209385-0.00700229668804j),(0.00532078353361-0.00947657308012j),(-0.00321477101737-0.000664571995283j),(0.00967879066665+0.00994324423794j),(12.0059012395-1.27858683324j),(-0.00193247815158-0.0106726689881j),(-0.00435217848192+0.00484670226863j),(0.0241724997852-0.0454355030035j),(-0.0320867625815+0.00579089117953j),(0.0213949056872+0.0294738831262j),(0.00199771343251-0.0055430487477j),(-0.0210394076132-0.0233558946355j),(10.4803566511+6.77508157339j),(-0.0156238398131+0.00783496409714j),(-0.029099054539+0.0181425688943j),(0.00304337744318-0.0194673672241j),(-0.0301261537297-0.00266195763839j),(0.00611696253626+0.0422895215298j),(0.0282531391161-0.0141111193048j),(0.0167717613952-0.000182506766915j),(-14.4718209368+5.09978969498j),(0.0034462970625+0.00991213760734j),(0.0337548891273+0.00496792150316j),(0.0054966333327-0.00265212929547j),(-0.0414430640162+0.0049483483302j),(0.000182155579405+0.0187738728213j),(-0.0183499640027-0.0160813651991j),(-0.0101370402567+0.0126759714347j),(-3.83470041679+0.965043091818j),(0.000516707411194-0.0081326427114j),(0.00408537631658-0.00354859760571j),(0.036746439084+0.00934169352472j),(-0.0408886448272+0.00353445860384j),(0.0465767568824+0.0206606515211j),(-0.0225795386264-0.000900194900137j),(-0.0146829095485-0.00440219684482j),(-11.4746634133-0.625819980308j),(-0.0246507082212-0.0238360783565j),(0.00910968105489-0.0151393879446j),(-0.0346329249671+0.0625974198544j),(0.0532162054821+0.00367559350265j),(-0.002418183401-0.0374734631264j),(-0.0360155483109+0.00474989942509j),(0.0195935590981-0.0144800162193j),(-1.00858734404-0.281346343619j),(0.00541564726615+0.032706298188j),(-0.0157787943583+0.043490817859j),(0.0271072696084-0.0149903077972j),(-0.134533691678-0.012629819554j),(0.0386026209209+0.00486741636604j),(-0.0253354399033+0.0174856164395j),(-0.0402534329302-0.00159852641806j),(-1.71221952276+0.226976208015j),(-0.0281399027729+0.00485639839724j),(-0.0419540911588-0.0311155530176j),(-0.0253839456713-0.0190381440324j),(0.0503267147975+0.00128181612721j),(-0.0175819002869-0.0167733484937j),(-0.0243259719364+0.0147972571612j),(0.0504070015121+0.0031496349664j),(-10.752574831-3.27092939802j),(0.0464522837621-0.0176732008679j),(0.0128493286845-0.0104404643822j),(0.0116683542581-0.0171348465931j),(0.0856083163729-0.0175906637213j),(0.0281671609227+0.0341971557223j),(0.0616175066435+0.011149733478j),(-0.00591081123506-0.0159707893793j),(-13.6500909077-2.94284481897j),(-0.0134135817271+0.0130337317064j),(0.0203201967778+0.0330958644413j),(0.00546007284082+0.0388524404288j),(0.0188114546221-0.0130673562868j),(-0.0113414713762-0.00878517669782j),(-0.0107534152977-0.00521120806972j),(0.0586783361511+0.00374423190996j),(20.6226653101-5.25264209675j),(0.0458115706187+0.021431241132j),(0.00034799128493+0.0192702352777j),(-0.02591163711-0.01813119158j),(-0.0139562057694-0.0115987986947j),(-0.00229615908521+0.0176459380101j),(-0.00249749541022-0.0459683727317j),(-0.0371750391158-0.0257206078553j),(-3.53564398206-2.75701175555j),(-0.0510264752711+0.0726408454475j),(0.000338200532358-0.00532596880014j),(0.00712623341992+0.0101934533209j),(-0.047114788772+0.0230981871648j),(0.0482590865543-0.0376117159984j),(-0.0264506330853+0.0406511071382j),(0.0181929552309+0.0410971021888j),(-12.3490606251-2.51671380091j),(0.02891704948-0.021054007329j),(-0.0384735199599-0.0228149424632j),(-0.0370612219887+0.0110191799452j),(-0.0856935380741+0.0168142440587j),(-0.00490397348829+0.021310517986j),(0.0519215859983+0.0353749723409j),(0.0219100855003+0.0288195424171j),(5.82014395967-0.556664106567j),(0.0008988530492-0.0378206622355j),(0.044752301788+0.0497599466643j),(-0.00380271485294-0.041902984986j),(0.0556745007854+0.000684807326119j),(-0.0166074292286+0.0336709130979j),(0.0126037822841+0.0225700217684j),(0.00110978841269-0.00433317215942j)]]

    WAVEFORMS =  [[ 149.898,351.848,1081.52,777.994,1339.63,786.688,1315.32,719.205,1252.37,978.272,1075.6,774.954,1193.86,795.462,1260.51,988.02,1024.51,687.174,1089.63,887.881,1125.48,846.175,1416.29,687.606,1296.4,673.876,1361.08,796.59,1475.75,593.022,1086.29,826.219,1303.24,628.397,951.088,870.108,1183.61,527.508,1114.31,1078.82,1274.41,536.906,1217.01,802.647,1421.46,993.465,1126.89,547.048,1016.71,923.544,1255.72,1057.82,1137.85,737.14,1303.13,1022.44,1541.59,643.865,1221.83,901.495,1222.6,718.633,1074.78,920.09,1094.77,685.934,1221.7,752.902,1342.03,844.215,1126.61,712.989,1356.21,692.756,1088.82,1039.65,1033.84,709.688,1290.09,859.764,1197.09,990.558,1142.77,744.794,1141.26,807.257,1101.87,797.12,1365.44,679.396,1083.12,750.278,1140.7,870.197,1209.91,784.336,1108.05,737.734,1138.48,1040.27,1214.29,661.351,1155.96,834.94,1132.57,1001.79,985.702,754.702,1161.34,674.675,1273.75,1078.89,997.388,662.354,1169.73,760.542,1727.17,656.866,982.878,851.006,1209.7,742.773,1319.38,911.632,1448.75,845.138,1266.08,790.852,1089.03,868.563,1232.03,1016.77,1037.16,818.089,1147.32,774.842,1343.61,763.871,1320.53,700.594,1256.57,916.119,1129.28,767.943,1052.66,817.847,1159.12,740.731,1234.17,639.623,1238.76,758.965,1209.38,781.759,1282.36,808.276,1106.74,739.53,1187.47,798.825,1185.33,867.118,1134.73,805.247,1233.52,855.97,1107.59,760.948,1363.32,696.581,1128.26,1061.67,1323.9,683.212,1336.83,958.712,1135.35,891.18,1141.05,752.53,1214.98,634.344,1086.56,792.511,1387.95,667.381,1058.74,767.644,1306.39,690.476,1268.51,738.81,1223.96,803.998,1088.89,982.353,1197.64,624.398,1090.53,466.892,120.699,75.8736,57.0535,47.8348,32.3475,40.6222,17.6283,31.6172,19.1317,23.4322,17.5859,19.6774,15.1629,19.9545,10.2939,17.6797,11.1104,14.8823,10.7482,12.8216,10.1747,13.5973,7.38168,12.4656,8.01208,11.095,7.7986,9.60694,7.7115,10.3986,5.78893,9.67228,6.32302,8.90649,6.13267,7.71354,6.22696,8.44525,4.77477,7.91639,5.24488,7.46492,5.05688,6.45677,5.2299,7.11995,4.06878,6.70622,4.49142,6.43773,4.30364,5.55865,4.51271,6.1591,3.54769,5.82049,3.93305,5.66648,3.74679,4.88381,3.97179,5.42992,3.14687,5.14415,3.50193,5.06537,3.31875,4.35803,3.54942,4.85775,2.82899,4.61118,3.15887,4.58362,2.97991,3.93703,3.21077,4.39722,2.57089,4.18088,2.87947,4.1891,2.70546,3.59267,2.93354,4.01906,2.35739,3.8267,2.64775,3.86042,2.47905,3.30614,2.70276,3.7035,2.1781,3.53062,2.45273,3.58277,2.28948,3.0644,2.50802,3.43668,2.02568,3.2799,2.2866,3.34551,2.12877,2.8581,2.3418,3.2086,1.89475,3.06532,2.14367,3.14083,1.99113,2.68034,2.19858,3.01182,1.78132,2.88,2.01967,2.96283,1.87221,2.52593,2.07419,2.84074,1.68231,2.71875,1.91132,2.80699,1.76871,2.39089,1.96541,2.69102,1.59537,2.57753,1.81609,2.66977,1.67807,2.27211,1.86976,2.55926,1.51862,2.45318,1.73198,2.54837,1.59827,2.16711,1.78523,2.44278,1.45056,2.34319,1.65738,2.44053,1.52771,2.07393,1.71025,2.3394,1.39,2.24554,1.59099,2.34443,1.46509,1.99095,1.64351,2.24736,1.33594,2.15857,1.53175,2.25858,1.40936,1.91687,1.58397,2.16521,1.28757,2.08093,1.47878,2.18172,1.35966,1.8506,1.53075,2.09176,1.24422,2.01151,1.43136,2.11284,1.31526,1.79124,1.48312,2.02602,1.20533,1.94937,1.38887,2.05106,1.27557,1.73803,1.44048,1.96714,1.17042,1.89372,1.3508,1.99566,1.24008,1.69033,1.40231,1.91443,1.13909,1.84392,1.31673,1.94602,1.20838,1.64761,1.36819,1.86729,1.11101,1.7994,1.28627,1.90162,1.18011,1.6094,1.33773,1.82521,1.08587,1.75968,1.25913,1.86201,1.15496,1.57533,1.31065,1.78777,1.06343,1.72436,1.23503,1.82681,1.13267,1.54505,1.28666,1.7546,1.04349,1.69311,1.21374,1.79569,1.11304,1.51828,1.26554,1.72539,1.02587,1.66563,1.19509,1.76838,1.09586,1.49479,1.2471,1.69987,1.0104,1.64166,1.17889,1.74465,1.08099,1.47437,1.23118,1.67783,0.996962,1.62102,1.16502,1.72429,1.0683,1.45685,1.21765,1.65907,0.985446,1.6035,1.15336,1.70715,1.05767,1.44209,1.20639,1.64344,0.975758,1.58899,1.14382,1.69309,1.04902,1.42996,1.19731,1.63081,0.967825,1.57735,1.13632,1.68199,1.04227,1.42038,1.19033,1.62109,0.961589,1.5685,1.13081,1.67378,1.03737,1.41327,1.18541,1.6142,0.957003,1.56236,1.12725,1.6684,1.03428,1.40858,1.18251,1.61008,0.954035,1.55889,1.1256,1.66581,1.03297,1.40628,1.1816,1.60872,0.952666,1.55808,1.12587,1.66599,1.03344,1.40636,1.18267,1.6101,0.952889,1.5599,1.12805,1.66895,1.0357,1.40881,1.18575,1.61423,0.954711,1.56439,1.13216,1.67472,1.03975,1.41366,1.19085,1.62116,0.958148,1.57157,1.13825,1.68334,1.04563,1.42096,1.19801,1.63094,0.963232,1.58151,1.14636,1.69489,1.05339,1.43077,1.20729,1.64366,0.970009,1.59429,1.15657,1.70946,1.0631,1.44317,1.21877,1.65942,0.978537,1.61003,1.16896,1.72718,1.07484,1.45828,1.23255,1.67836,0.988891,1.62884,1.18364,1.7482,1.08871,1.47622,1.24875,1.70065,1.00116,1.65091,1.20075,1.7727,1.10483,1.49715,1.26749,1.72649,1.01547,1.67644,1.22044,1.80091,1.12336,1.52128,1.28897,1.75613,1.03194,1.70565,1.24291,1.8331,1.14446,1.54884,1.31337,1.78985,1.05074,1.73883,1.26837,1.86956,1.16835,1.58009,1.34094,1.828,1.07205,1.77632,1.29709,1.91068,1.19527,1.61537,1.37195,1.87097,1.09611,1.81851,1.32939,1.95688,1.22552,1.65505,1.40674,1.91924,1.12317,1.86586,1.36563,2.00869,1.25943,1.6996,1.4457,1.97336,1.15355,1.91894,1.40626,2.0667,1.29741,1.74956,1.48929,2.03402,1.18762,1.97838,1.45178,2.13163,1.33995,1.80555,1.53806,2.10201,1.22584,2.04498,1.50284,2.20437,1.38762,1.86837,1.59266,2.17827,1.26875,2.11967,1.56017,2.28593,1.44113,1.93894,1.6539,2.26397,1.31698,2.20359,1.62469,2.37759,1.50132,2.01839,1.72272,2.36051,1.37134,2.29811,1.69752,2.48086,1.56922,2.10811,1.8003,2.46961,1.4328,2.40495,1.78003,2.59765,1.64611,2.20981,1.88808,2.59341,1.50258,2.52619,1.87393,2.7303,1.73358,2.32564,1.98787,2.73459,1.5822,2.6645,1.9814,2.88179,1.83365,2.45834,2.10195,2.89655,1.67362,2.82326,2.10521,3.05592,1.9489,2.6114,2.23323,3.08369,1.77935,3.00684,2.24898,3.25763,2.0827,2.78943,2.38554,3.30178,1.90275,3.221,2.4175,3.49347,2.23953,2.99858,2.56395,3.55857,2.04831,3.4735,2.61728,3.77231,2.42549,3.24725,2.77537,3.86465,2.22225,3.77507,2.85735,4.10651,2.64911,3.54727,3.02945,4.23502,2.43345,4.14094,3.15065,4.51376,2.92266,3.91581,3.34017,4.69152,2.69499,4.59351,3.51638,5.02041,3.26459,4.37884,3.72857,5.26735,3.02705,5.16729,3.98433,5.66759,3.70388,4.97759,4.22792,6.01561,3.46246,5.91831,4.60331,6.52323,4.28906,5.78183,4.89449,7.02698,4.05868,6.94436,5.45926,7.70873,5.10812,6.91996,5.83219,8.4705,4.92632,8.43343,6.71874,9.46538,6.33978,8.65755,7.25892,10.7033,6.31069,10.802,8.75276,12.3559,8.41414,11.6516,9.73386,14.6435,8.89484,15.213,12.592,18.104,12.7208,18.1312,15.3556,23.6976,15.6688,26.8905,22.6229,36.5608,28.4504,45.1221,48.5462,79.961,105.468,419.603,1132.69,838.806,1035.82,837.483,1352.54,649.416,1094.24,867.21,1238.1,760.712,1047.64,827.025,1199.15,836.278,1231.89,736.767,1562.09,591.16,1140.6,869.392,1170.48,643.55,1175.93,807.426,1087.04,632.399,1265.64,841.824,1241.29,793.866,1287.2,877.456,1083.07,867.865,1401.72,1014.12,880.767,882.138,1204.51,859.272,1371.78,735.975,1208.79,726.469,1442.74,763.461,1187.56,689.523,1505.64,746.313,1410.43,753.152,1226.12,709.548,1043.36,684.658,1300.79,770.031,1292.56,783.224,1006.73,1061.23,1062.32,887.931,870.31,878.836,1266.36,849.414,1246.87,725.851,1379.95,818.108,1231.73,746.863,1101.97,802.131,1287.11,845.238,1145.55,784.527,1507.15,634.434,1206.17,1050.62,1140.83,788.695,1110.11,803.209,1217.81,934.092,1182.23,927.212,1297.58,683.741,1162.44,908.206,1095.59,801.07,1056.94,814.959,1107.14,613.636,1159.13,915.127,1254.86,678.005,1182.34,1022.96,969.239,832.325,1176.39,645.553,1467.85,673.585,1044.11,771.859,1300.26,761.862,1064.57,951.771,906.952,812.715,1097.76,960.858,1044.67,701.437,1234.54,754.773,1110.26,830.513,1174.98,1005.22,834.229,857.655,1001.28,771.844,1382.09,656.766,1177.07,854.484,1154.82,717.635,1540.43,797.358,1293.13,879.713,1225.36,840.843,1258.48,597.523,1146.51,966.109,1180.51,669.032,1305.82,774.978,1352.06,806.816,1164.57,822.598,1280.58,663.3,1117.02,837.976,1186.02,900.427,1076.56,664.223,1436.67,759.167,1276.81,842.046,1342.14,710.215,1168.66,906.726,1226.58,708.7,1134.92,714.449,942.935,836.526,1096.65,691.988,1476.33,896.358,1388.66,869.801,1214.97,704.185,1151.18,851.56,1086.1,850.811,1078.57,683.532,1105.83,397.229,93.948,101.277
]]

    def __init__(self, threshold, waveforms=WAVEFORMS):
        """
        CTOR
        @param threshold Decision threshold
        @param waveforms Array of known patterns
        """
        ThresholdAlgorithm.__init__(self, threshold=threshold)

	self._waveforms = waveforms

        Logger.register('waveform_decision', ['decision', ])

	self._xx = {};
	self._xx[0] = {0: "00", 1: "01"}
	self._xx[1] = {0: "10", 1: "11"}

    ##@abstractmethod
    def decision(self, data_in):
        """
        Called from a signal processing block to made a decision.
        @param data_in Mag squared of samples.
        @return Tuple (status, correlation).
        """
        max_corr = -1.0

        for wave in self._waveforms:
            max_corr = max(abs(self.correlate(wave, data_in)), max_corr)

	dec = 1 if self.threshold < max_corr else 0

        Logger.append('waveform_decision', 'decision', self._xx[Logger._ch_status][dec])


        return dec, max_corr


    def correlate(self, pattern, signal):
        """
        Correlates a signal waveform with a known pattern.
        @param pattern Known pattern.
        @param signal Received signal.
        """
	return sc.spearmanr( signal, pattern )[0]
